<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.6"?>
<plugin>

   <extension
         id="remotingBuilder"
         name="JRebel Remote Server Configuration Builder"
         point="org.eclipse.core.resources.builders">
      <builder
            hasNature="true">
         <run class="org.zeroturnaround.eclipse.jrebel.remoting.builder.RemotingBuilder" />         
      </builder>
   </extension>
   <extension
         id="remotingNature"
         name="JRebel Remote Server Nature"
         point="org.eclipse.core.resources.natures">
      <runtime>
         <run class="org.zeroturnaround.eclipse.jrebel.remoting.RemotingProject">
         </run>
      </runtime>
      <builder id="org.zeroturnaround.eclipse.remoting.remotingBuilder">
      </builder>
   </extension>
   <extension
         point="org.eclipse.ui.popupMenus">
      <objectContribution
            adaptable="true"
            objectClass="org.eclipse.core.resources.IProject"
            id="org.zeroturnaround.eclipse.remoting.remotingProjectActions">
         <action
               class="org.zeroturnaround.eclipse.jrebel.remoting.actions.SyncNowAction"
               enablesFor="+"
               icon="icons/zt-cloud-icon.png"
               id="org.zeroturnaround.eclipse.remoting.syncNowAction"
               label="Synchronize"
               menubarPath="org.zeroturnaround.eclipse.rebelMenu/rebelRemoting">
         </action>         
         <action
               class="org.zeroturnaround.eclipse.jrebel.remoting.actions.ToggleNatureAction"
               enablesFor="1"
               icon="icons/zt-cloud-icon.png"
               id="org.zeroturnaround.eclipse.remoting.addRemoveNatureAction"
               label="Enable/Disable Remoting"
               menubarPath="org.zeroturnaround.eclipse.rebelMenu/rebelRemoting"
               style="toggle">
         </action>
         <visibility>
            <and>
               <objectState
                     name="nature"
                     value="org.zeroturnaround.eclipse.jrebelNature">
               </objectState>
               <not>
                  <objectState
                        name="persistentProperty"
                        value="org.zeroturnaround.eclipse.jrebel.jrebelDisabled=true">
                  </objectState>
               </not>
            </and>
         </visibility>
      </objectContribution>
   </extension>

   
    <extension
         id="rebelRemotingProblem"
         name="JRebel Remote Server Problem"
         point="org.eclipse.core.resources.markers">
      <super
            type="org.eclipse.core.resources.problemmarker">
      </super>
      <persistent
            value="true">
      </persistent>
   </extension>
    <extension
          point="org.eclipse.ui.console.consolePageParticipants">
       <consolePageParticipant
             class="org.zeroturnaround.eclipse.jrebel.remoting.console.RemotingConsolePageParticipant"
             id="org.zeroturnaround.eclipse.jrebel.remoting.console.RemotingConsolePageParticipant">
          <enablement>
             <test
                   property="org.eclipse.ui.console.consoleTypeTest"
                   value="JRebelRemoting">
             </test></enablement>
       </consolePageParticipant>
    </extension>
    <extension
          point="org.eclipse.ui.intro.configExtension">
       <configExtension
             configId="org.eclipse.ui.intro.universalConfig"
             content="intro/overview.xml">
       </configExtension>
    </extension>
    <extension
          point="org.eclipse.core.runtime.preferences">
       <initializer
             class="org.zeroturnaround.eclipse.jrebel.remoting.preferences.PreferenceInitializer">
       </initializer>
    </extension>
    <extension
          point="org.zeroturnaround.eclipse.remotingProvider">
       <remotingProvider
             class="org.zeroturnaround.eclipse.jrebel.remoting.RebelRemotingProvider">
       </remotingProvider>
    </extension>
    <extension
          point="org.eclipse.ui.console.consoleFactories">
       <consoleFactory
             class="org.zeroturnaround.eclipse.jrebel.remoting.console.RemotingConsoleFactory"
             icon="icons/zt-cloud-icon.png"
             label="JRebel Remote Servers">
       </consoleFactory>
    </extension>
    <extension
          point="org.eclipse.ui.startup">
       <startup
             class="org.zeroturnaround.eclipse.jrebel.remoting.RemotingPluginStartup">
       </startup>
    </extension>
    <extension
          point="org.eclipse.ui.menus">
       <menuContribution
             allPopups="false"
             locationURI="menu:org.eclipse.ui.run?before=breakpointGroup">
          <command
                commandId="org.zeroturnaround.eclipse.remoting.synchronize"
                icon="icons/zt-cloud-icon.png"
                label="Synchronize with JRebel"
                style="push">
          </command>
       </menuContribution>
       <menuContribution
             allPopups="false"
             locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
          <toolbar
                id="org.zeroturnaround.eclipse.remoting.toolbar">
             <command
                   commandId="org.zeroturnaround.eclipse.remoting.synchronize"
                   icon="icons/jr-cloud-main-light.png"
                   id="org.zeroturnaround.eclipse.remoting.toolbar.synchronize"
                   style="pulldown"
                   tooltip="Synchronize">
                <visibleWhen
                      checkEnabled="false">
                   <with 
                         variable="org.zeroturnaround.eclipse.jrebel.remoting.license">
                      <equals
                            value="true">
                      </equals>
                   </with>                         
                </visibleWhen>
             </command>
          </toolbar>
       </menuContribution>
       <menuContribution
             allPopups="false"
             locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
          <toolbar
                id="org.zeroturnaround.eclipse.remoting.toolbar">
             <command
                   commandId="org.zeroturnaround.eclipse.commands.activateJRebelPopup"
                   icon="icons/jr-cloud-unavailable-light.png"
                   id="org.zeroturnaround.eclipse.remoting.toolbar.activate"
                   style="pulldown"
                   tooltip="JRebel is not activated - to activate go to Help -&gt; JRebel Activation">
                <visibleWhen
                      checkEnabled="false">
                   <with 
                         variable="org.zeroturnaround.eclipse.jrebel.remoting.license">
                      <equals
                            value="false">
                      </equals>
                   </with>                         
                </visibleWhen>
             </command>
          </toolbar>
       </menuContribution>
       <menuContribution
             allPopups="false"
             locationURI="menu:org.zeroturnaround.eclipse.remoting.toolbar.synchronize">
          <dynamic
                class="org.zeroturnaround.eclipse.jrebel.remoting.extensions.menu.SyncMenuItems"
                id="org.zeroturnaround.eclipse.remoting.synchronize.items">
          </dynamic>
       </menuContribution>
       <menuContribution
             allPopups="false"
             locationURI="menu:org.zeroturnaround.eclipse.remoting.toolbar.activate">
          <command
                commandId="org.zeroturnaround.eclipse.commands.activateJRebelPopup"
                icon="icons/jrebel_16x16.png"
                label="Activate JRebel"
                style="push">
          </command>
       </menuContribution>
    </extension>
    <extension
          point="org.eclipse.ui.commands">
       <command
             id="org.zeroturnaround.eclipse.remoting.synchronize"
             name="Synchronize">
       </command>
    </extension>
    <extension
          point="org.eclipse.ui.handlers">
       <handler
             class="org.zeroturnaround.eclipse.jrebel.remoting.extensions.handlers.SynchronizeCommandHandler"
             commandId="org.zeroturnaround.eclipse.remoting.synchronize">
          <enabledWhen>
             <with 
                   variable="org.zeroturnaround.eclipse.jrebel.remoting.license">
                 <equals
                       value="true">
                 </equals>
             </with>
          </enabledWhen>
       </handler>
    </extension>
    <extension
          point="org.eclipse.ui.services">
       <sourceProvider
             provider="org.zeroturnaround.eclipse.jrebel.remoting.extensions.sourceproviders.ActivationState">
          <variable
                name="org.zeroturnaround.eclipse.jrebel.remoting.license"
                priorityLevel="workbench">
          </variable>
       </sourceProvider>
    </extension>
   
</plugin>
